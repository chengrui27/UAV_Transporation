该目录下的multi_payload中的python文件都通过ACADOS实现了多无人机的吊运的控制器；
我在gazebo中创建了相同的场景，我希望在multi_payload功能包中写一个节点，该节点能够读取无人机和负载的信息，并调用ACADOS生成的NMPC控制器，完成无人机集群吊运任务；
该工作空间的说明可以通过AGENTS.md获得，下面是一些详细的说明：

我通过在PX4-Autopilot中执行./Tools/gazebo_sitl_multiple_run.sh -t px4_sitl_default -w multi_trans -s "iris:1:2.1:0,iris:1:-0.3:1.9,iris:1:-0.3:-1.9"这个命令来启动gazebo仿真，生成负载、连杆和三架无人机；
随后我通过PX4-Autopilot中的./start_mavros_multi.sh脚本启动mavros连接三架无人机，能够接收到的话题如下所示：
/clock
/diagnostics
/move_base_simple/goal
/parameter_events
/payload/odom
/performance_metrics
/rosout
/tf
/tf_static
/uas1/mavlink_sink
/uas1/mavlink_source
/uas2/mavlink_sink
/uas2/mavlink_source
/uas3/mavlink_sink
/uas3/mavlink_source
/uav1/actuator_control
/uav1/adsb/send
/uav1/adsb/vehicle
/uav1/altitude
/uav1/battery
/uav1/cam_imu_sync/cam_imu_stamp
/uav1/camera/image_captured
/uav1/cellular_status/status
/uav1/companion_process/status
/uav1/debug_value/debug
/uav1/debug_value/debug_float_array
/uav1/debug_value/debug_vector
/uav1/debug_value/named_value_float
/uav1/debug_value/named_value_int
/uav1/debug_value/send
/uav1/esc_status/info
/uav1/esc_status/status
/uav1/esc_telemetry/telemetry
/uav1/estimator_status
/uav1/extended_state
/uav1/fake_gps/mocap/tf
/uav1/geofence/fences
/uav1/gimbal_control/device/attitude_status
/uav1/gimbal_control/device/info
/uav1/gimbal_control/device/set_attitude
/uav1/gimbal_control/manager/info
/uav1/gimbal_control/manager/set_attitude
/uav1/gimbal_control/manager/set_manual_control
/uav1/gimbal_control/manager/set_pitchyaw
/uav1/gimbal_control/manager/status
/uav1/global_position/compass_hdg
/uav1/global_position/global
/uav1/global_position/gp_lp_offset
/uav1/global_position/gp_origin
/uav1/global_position/local
/uav1/global_position/raw/fix
/uav1/global_position/raw/gps_vel
/uav1/global_position/raw/satellites
/uav1/global_position/rel_alt
/uav1/global_position/set_gp_origin
/uav1/gps_input/gps_input
/uav1/gps_rtk/rtk_baseline
/uav1/gps_rtk/send_rtcm
/uav1/gpsstatus/gps1/raw
/uav1/gpsstatus/gps1/rtk
/uav1/gpsstatus/gps2/raw
/uav1/gpsstatus/gps2/rtk
/uav1/hil/actuator_controls
/uav1/hil/controls
/uav1/hil/gps
/uav1/hil/imu_ned
/uav1/hil/optical_flow
/uav1/hil/rc_inputs
/uav1/hil/state
/uav1/home_position/home
/uav1/home_position/set
/uav1/imu/data
/uav1/imu/data_raw
/uav1/imu/diff_pressure
/uav1/imu/mag
/uav1/imu/static_pressure
/uav1/imu/temperature_baro
/uav1/imu/temperature_imu
/uav1/landing_target/lt_marker
/uav1/landing_target/pose
/uav1/landing_target/pose_in
/uav1/local_position/accel
/uav1/local_position/odom
/uav1/local_position/pose
/uav1/local_position/pose_cov
/uav1/local_position/velocity_body
/uav1/local_position/velocity_body_cov
/uav1/local_position/velocity_local
/uav1/log_transfer/raw/log_data
/uav1/log_transfer/raw/log_entry
/uav1/mag_calibration/report
/uav1/mag_calibration/status
/uav1/manual_control/control
/uav1/manual_control/send
/uav1/mission/reached
/uav1/mission/waypoints
/uav1/mocap/pose
/uav1/mocap/tf
/uav1/mount_control/command
/uav1/mount_control/orientation
/uav1/mount_control/status
/uav1/nav_controller_output/output
/uav1/obstacle/send
/uav1/odometry/in
/uav1/odometry/out
/uav1/onboard_computer/status
/uav1/open_drone_id/basic_id
/uav1/open_drone_id/operator_id
/uav1/open_drone_id/self_id
/uav1/open_drone_id/system
/uav1/open_drone_id/system_update
/uav1/optical_flow/ground_distance
/uav1/optical_flow/raw/optical_flow
/uav1/optical_flow/raw/send
/uav1/param/event
/uav1/play_tune
/uav1/px4flow/ground_distance
/uav1/px4flow/raw/optical_flow_rad
/uav1/px4flow/raw/send
/uav1/px4flow/temperature
/uav1/radio_status
/uav1/rallypoint/rallypoints
/uav1/rc/in
/uav1/rc/out
/uav1/rc/override
/uav1/setpoint_accel/accel
/uav1/setpoint_attitude/cmd_vel
/uav1/setpoint_attitude/thrust
/uav1/setpoint_position/global
/uav1/setpoint_position/global_to_local
/uav1/setpoint_position/local
/uav1/setpoint_raw/attitude
/uav1/setpoint_raw/global
/uav1/setpoint_raw/local
/uav1/setpoint_raw/target_attitude
/uav1/setpoint_raw/target_global
/uav1/setpoint_raw/target_local
/uav1/setpoint_trajectory/desired
/uav1/setpoint_trajectory/local
/uav1/setpoint_velocity/cmd_vel
/uav1/setpoint_velocity/cmd_vel_unstamped
/uav1/state
/uav1/status_event
/uav1/statustext/recv
/uav1/statustext/send
/uav1/sys_status
/uav1/target_actuator_control
/uav1/terrain/report
/uav1/time_reference
/uav1/timesync_status
/uav1/trajectory/desired
/uav1/trajectory/generated
/uav1/trajectory/path
/uav1/tunnel/in
/uav1/tunnel/out
/uav1/vfr_hud
/uav1/vision_pose/pose
/uav1/vision_pose/pose_cov
/uav1/vision_speed/speed_twist
/uav1/vision_speed/speed_twist_cov
/uav1/vision_speed/speed_vector
/uav1/wind_estimation
/uav2/actuator_control
/uav2/adsb/send
/uav2/adsb/vehicle
/uav2/altitude
/uav2/battery
/uav2/cam_imu_sync/cam_imu_stamp
/uav2/camera/image_captured
/uav2/cellular_status/status
/uav2/companion_process/status
/uav2/debug_value/debug
/uav2/debug_value/debug_float_array
/uav2/debug_value/debug_vector
/uav2/debug_value/named_value_float
/uav2/debug_value/named_value_int
/uav2/debug_value/send
/uav2/esc_status/info
/uav2/esc_status/status
/uav2/esc_telemetry/telemetry
/uav2/estimator_status
/uav2/extended_state
/uav2/fake_gps/mocap/tf
/uav2/geofence/fences
/uav2/gimbal_control/device/attitude_status
/uav2/gimbal_control/device/info
/uav2/gimbal_control/device/set_attitude
/uav2/gimbal_control/manager/info
/uav2/gimbal_control/manager/set_attitude
/uav2/gimbal_control/manager/set_manual_control
/uav2/gimbal_control/manager/set_pitchyaw
/uav2/gimbal_control/manager/status
/uav2/global_position/compass_hdg
/uav2/global_position/global
/uav2/global_position/gp_lp_offset
/uav2/global_position/gp_origin
/uav2/global_position/local
/uav2/global_position/raw/fix
/uav2/global_position/raw/gps_vel
/uav2/global_position/raw/satellites
/uav2/global_position/rel_alt
/uav2/global_position/set_gp_origin
/uav2/gps_input/gps_input
/uav2/gps_rtk/rtk_baseline
/uav2/gps_rtk/send_rtcm
/uav2/gpsstatus/gps1/raw
/uav2/gpsstatus/gps1/rtk
/uav2/gpsstatus/gps2/raw
/uav2/gpsstatus/gps2/rtk
/uav2/hil/actuator_controls
/uav2/hil/controls
/uav2/hil/gps
/uav2/hil/imu_ned
/uav2/hil/optical_flow
/uav2/hil/rc_inputs
/uav2/hil/state
/uav2/home_position/home
/uav2/home_position/set
/uav2/imu/data
/uav2/imu/data_raw
/uav2/imu/diff_pressure
/uav2/imu/mag
/uav2/imu/static_pressure
/uav2/imu/temperature_baro
/uav2/imu/temperature_imu
/uav2/landing_target/lt_marker
/uav2/landing_target/pose
/uav2/landing_target/pose_in
/uav2/local_position/accel
/uav2/local_position/odom
/uav2/local_position/pose
/uav2/local_position/pose_cov
/uav2/local_position/velocity_body
/uav2/local_position/velocity_body_cov
/uav2/local_position/velocity_local
/uav2/log_transfer/raw/log_data
/uav2/log_transfer/raw/log_entry
/uav2/mag_calibration/report
/uav2/mag_calibration/status
/uav2/manual_control/control
/uav2/manual_control/send
/uav2/mission/reached
/uav2/mission/waypoints
/uav2/mocap/pose
/uav2/mocap/tf
/uav2/mount_control/command
/uav2/mount_control/orientation
/uav2/mount_control/status
/uav2/nav_controller_output/output
/uav2/obstacle/send
/uav2/odometry/in
/uav2/odometry/out
/uav2/onboard_computer/status
/uav2/open_drone_id/basic_id
/uav2/open_drone_id/operator_id
/uav2/open_drone_id/self_id
/uav2/open_drone_id/system
/uav2/open_drone_id/system_update
/uav2/optical_flow/ground_distance
/uav2/optical_flow/raw/optical_flow
/uav2/optical_flow/raw/send
/uav2/param/event
/uav2/play_tune
/uav2/px4flow/ground_distance
/uav2/px4flow/raw/optical_flow_rad
/uav2/px4flow/raw/send
/uav2/px4flow/temperature
/uav2/radio_status
/uav2/rallypoint/rallypoints
/uav2/rc/in
/uav2/rc/out
/uav2/rc/override
/uav2/setpoint_accel/accel
/uav2/setpoint_attitude/cmd_vel
/uav2/setpoint_attitude/thrust
/uav2/setpoint_position/global
/uav2/setpoint_position/global_to_local
/uav2/setpoint_position/local
/uav2/setpoint_raw/attitude
/uav2/setpoint_raw/global
/uav2/setpoint_raw/local
/uav2/setpoint_raw/target_attitude
/uav2/setpoint_raw/target_global
/uav2/setpoint_raw/target_local
/uav2/setpoint_trajectory/desired
/uav2/setpoint_trajectory/local
/uav2/setpoint_velocity/cmd_vel
/uav2/setpoint_velocity/cmd_vel_unstamped
/uav2/state
/uav2/status_event
/uav2/statustext/recv
/uav2/statustext/send
/uav2/sys_status
/uav2/target_actuator_control
/uav2/terrain/report
/uav2/time_reference
/uav2/timesync_status
/uav2/trajectory/desired
/uav2/trajectory/generated
/uav2/trajectory/path
/uav2/tunnel/in
/uav2/tunnel/out
/uav2/vfr_hud
/uav2/vision_pose/pose
/uav2/vision_pose/pose_cov
/uav2/vision_speed/speed_twist
/uav2/vision_speed/speed_twist_cov
/uav2/vision_speed/speed_vector
/uav2/wind_estimation
/uav3/actuator_control
/uav3/adsb/send
/uav3/adsb/vehicle
/uav3/altitude
/uav3/battery
/uav3/cam_imu_sync/cam_imu_stamp
/uav3/camera/image_captured
/uav3/cellular_status/status
/uav3/companion_process/status
/uav3/debug_value/debug
/uav3/debug_value/debug_float_array
/uav3/debug_value/debug_vector
/uav3/debug_value/named_value_float
/uav3/debug_value/named_value_int
/uav3/debug_value/send
/uav3/esc_status/info
/uav3/esc_status/status
/uav3/esc_telemetry/telemetry
/uav3/estimator_status
/uav3/extended_state
/uav3/fake_gps/mocap/tf
/uav3/geofence/fences
/uav3/gimbal_control/device/attitude_status
/uav3/gimbal_control/device/info
/uav3/gimbal_control/device/set_attitude
/uav3/gimbal_control/manager/info
/uav3/gimbal_control/manager/set_attitude
/uav3/gimbal_control/manager/set_manual_control
/uav3/gimbal_control/manager/set_pitchyaw
/uav3/gimbal_control/manager/status
/uav3/global_position/compass_hdg
/uav3/global_position/global
/uav3/global_position/gp_lp_offset
/uav3/global_position/gp_origin
/uav3/global_position/local
/uav3/global_position/raw/fix
/uav3/global_position/raw/gps_vel
/uav3/global_position/raw/satellites
/uav3/global_position/rel_alt
/uav3/global_position/set_gp_origin
/uav3/gps_input/gps_input
/uav3/gps_rtk/rtk_baseline
/uav3/gps_rtk/send_rtcm
/uav3/gpsstatus/gps1/raw
/uav3/gpsstatus/gps1/rtk
/uav3/gpsstatus/gps2/raw
/uav3/gpsstatus/gps2/rtk
/uav3/hil/actuator_controls
/uav3/hil/controls
/uav3/hil/gps
/uav3/hil/imu_ned
/uav3/hil/optical_flow
/uav3/hil/rc_inputs
/uav3/hil/state
/uav3/home_position/home
/uav3/home_position/set
/uav3/imu/data
/uav3/imu/data_raw
/uav3/imu/diff_pressure
/uav3/imu/mag
/uav3/imu/static_pressure
/uav3/imu/temperature_baro
/uav3/imu/temperature_imu
/uav3/landing_target/lt_marker
/uav3/landing_target/pose
/uav3/landing_target/pose_in
/uav3/local_position/accel
/uav3/local_position/odom
/uav3/local_position/pose
/uav3/local_position/pose_cov
/uav3/local_position/velocity_body
/uav3/local_position/velocity_body_cov
/uav3/local_position/velocity_local
/uav3/log_transfer/raw/log_data
/uav3/log_transfer/raw/log_entry
/uav3/mag_calibration/report
/uav3/mag_calibration/status
/uav3/manual_control/control
/uav3/manual_control/send
/uav3/mission/reached
/uav3/mission/waypoints
/uav3/mocap/pose
/uav3/mocap/tf
/uav3/mount_control/command
/uav3/mount_control/orientation
/uav3/mount_control/status
/uav3/nav_controller_output/output
/uav3/obstacle/send
/uav3/odometry/in
/uav3/odometry/out
/uav3/onboard_computer/status
/uav3/open_drone_id/basic_id
/uav3/open_drone_id/operator_id
/uav3/open_drone_id/self_id
/uav3/open_drone_id/system
/uav3/open_drone_id/system_update
/uav3/optical_flow/ground_distance
/uav3/optical_flow/raw/optical_flow
/uav3/optical_flow/raw/send
/uav3/param/event
/uav3/play_tune
/uav3/px4flow/ground_distance
/uav3/px4flow/raw/optical_flow_rad
/uav3/px4flow/raw/send
/uav3/px4flow/temperature
/uav3/radio_status
/uav3/rallypoint/rallypoints
/uav3/rc/in
/uav3/rc/out
/uav3/rc/override
/uav3/setpoint_accel/accel
/uav3/setpoint_attitude/cmd_vel
/uav3/setpoint_attitude/thrust
/uav3/setpoint_position/global
/uav3/setpoint_position/global_to_local
/uav3/setpoint_position/local
/uav3/setpoint_raw/attitude
/uav3/setpoint_raw/global
/uav3/setpoint_raw/local
/uav3/setpoint_raw/target_attitude
/uav3/setpoint_raw/target_global
/uav3/setpoint_raw/target_local
/uav3/setpoint_trajectory/desired
/uav3/setpoint_trajectory/local
/uav3/setpoint_velocity/cmd_vel
/uav3/setpoint_velocity/cmd_vel_unstamped
/uav3/state
/uav3/status_event
/uav3/statustext/recv
/uav3/statustext/send
/uav3/sys_status
/uav3/target_actuator_control
/uav3/terrain/report
/uav3/time_reference
/uav3/timesync_status
/uav3/trajectory/desired
/uav3/trajectory/generated
/uav3/trajectory/path
/uav3/tunnel/in
/uav3/tunnel/out
/uav3/vfr_hud
/uav3/vision_pose/pose
/uav3/vision_pose/pose_cov
/uav3/vision_speed/speed_twist
/uav3/vision_speed/speed_twist_cov
/uav3/vision_speed/speed_vector
/uav3/wind_estimation
随后我通过status_estimate功能包发布无人机的外部位置信息，将无人机都统一到世界坐标系；

下面是我要实现的要求：
1、修改原有的multi_offboard_node节点，在确保无人机都具备解锁和起飞条件后，同时通过定点模式起飞到起飞，三架无人机的起飞位置分别如下
   iris1(0.8, 0, 2)  iris2(-0.4, 0.5, 2)  iris3(-0.4, -0.5, 2)
   同时修改该节点的名字为multi_payload_node

2、读取和计算NMPC所需要的状态信息，需要读取东西的包括负载位置、速度、四元数、角速度，无人机的位置、速度、四元数，随后根据负载的位置和姿态、无人机的位置、以及绳子在负载上的挂点计算绳子的单位方向向量，在通过绳子朝向的方向向量计算绳子转动角速度（q_dot = omega × q）
   计算和读取的方式可以参考px4_payload_nmpc功能包中的nmpc_controller.cpp
   计算的时候注意不要搞错了无人机的顺序和位置

3、调用multi_payload中利用ACADOS创建的NMPC求解器，以100Hz的频率解算，在无人机通过定点模式起飞并稳定悬停后再开始解算，保证NMPC有一个较好的初始状态，防止求解器崩溃
   实现方式可以参考px4_payload_nmpc功能包中的nmpc_controller.cpp，但是不需要考虑避障的部分

4、在确认NMPC能够正确计算后，通过/mavros/setpoint_raw/attitude向无人机发送控制信号，使用推力和角速度控制无人机，并进入offboard模式

5、能够通过rviz2的/goal_pose来指定负载的目标位置，实现方式可以参考px4_payload_nmpc功能包中的nmpc_controller.cpp

6、想要整个代码的结构规范一些，不要一个文件过于冗长，可以采用多文件编程，比如用一个.cpp和.h文件来定义一个类来实现一个功能，在multi_payload_node节点中只要调用这些类和函数


1、首先修改初始yref，将负载目标位置设置为（0, 0, 0.5），将绳子设置为竖直向下，无人机和负载的姿态都设置为水平朝前（1, 0, 0, 0）
2、在首次设置初始状态时，能够读取的观测量都用最新的观测量覆盖
3、将能够观测到的状态变量都打印出来